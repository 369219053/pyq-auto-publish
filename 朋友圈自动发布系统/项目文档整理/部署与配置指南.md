# éƒ¨ç½²ä¸é…ç½®æŒ‡å—

[â† è¿”å›README](./README.md)

---

## ğŸ“‹ å¿«é€Ÿå¯¼èˆª

- [æœåŠ¡å™¨ä¿¡æ¯](#-æœåŠ¡å™¨ä¿¡æ¯)
- [ç¯å¢ƒå˜é‡é…ç½®](#-ç¯å¢ƒå˜é‡é…ç½®)
- [æœ¬åœ°å¼€å‘ç¯å¢ƒ](#-æœ¬åœ°å¼€å‘ç¯å¢ƒ)
- [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#-ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
- [ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®](#-ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®)
- [æ•°æ®åº“é…ç½®](#-æ•°æ®åº“é…ç½®)
- [éƒ¨ç½²è·¯å¾„](#-éƒ¨ç½²è·¯å¾„)
- [å¸¸ç”¨éƒ¨ç½²å‘½ä»¤](#-å¸¸ç”¨éƒ¨ç½²å‘½ä»¤)
- [ç§»åŠ¨ç«¯è®¿é—®](#-ç§»åŠ¨ç«¯è®¿é—®)

---

## ğŸ–¥ï¸ æœåŠ¡å™¨ä¿¡æ¯

### ç”Ÿäº§æœåŠ¡å™¨

**é‡è¦**: é¡¹ç›®åªä½¿ç”¨ä¸€å°æœåŠ¡å™¨,ä¸è¦ææ··!

- **æœåŠ¡å™¨IP**: `124.223.35.102`
- **SSHç”¨æˆ·**: `root`
- **SSHè®¤è¯**: å·²é…ç½®å¯†é’¥å…å¯†ç™»å½•
- **å®å¡”é¢æ¿**: https://124.223.35.102:17005/ea21ab66
  - ç”¨æˆ·å: `hkptv7pa`
  - å¯†ç : `3435525a`

### SSHå¯†é’¥é…ç½®

æœ¬åœ°å…¬é’¥å·²æ·»åŠ åˆ°æœåŠ¡å™¨ `~/.ssh/authorized_keys`:

```
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDDW1bK2PI4AYg4utTXmyeyGRfrv9iDMi4PJsEEI13A8nlVIjDOugiICxQftXLPULxaSbO0wNWsF7YPe+Zdmy+wYhjTXJGlCvqUtKXmA2FAUbLBwMtdxOW3G4nOd0EXdXjFe6tevj7MW0eemdtW2Y1q6aZQBOHmAbkCBN1cvBdJ2Xphj6vZ18V4pY7R/4fWUE2kmbXLRSgjPZBcsHA3/EBBBMmojeGmUL2xIcUkhF8vzb/fNNTvFZ57T94nNd6OEXHiAoojDu6Z3ABxZMyNzGd9/mL5Prutz3FDFDsDCPYr3DxtS8+9utr5GEmTAR/ogGMdW73iNXaPQDe4h1HQdYQsQYI7rQt3xUf4LYMfSOOQBm0zhUyaRR/841zIEOempfs16NXEbY/oaEMINsP3YJ34FBDH+ds4rJbCUmGJqJwZ02Cufon9E63QzTnH/C8XIlUAL7E0J30P09OOwFaBZsH8nTYNPvi54MwbtITslsuyie1w6ivAP32N0sDRoYeLc48rq4xfKaHcbSrPMXU0ODn6XtlffJm4cpptjDraVxU2orCJd0cbNdKQmH2dr4WgdbMF2VBfTo3tEcUvI7H7QCOX/4/Zb/LhTQYS0oXk9p0qQ9eODNW2Zanq48tl4oCZWw4lMRlYnu/vCbMNvkdZ0mjJTgrHltyRuvFREZURPxmB8w== your_email@example.com
```

### SSHè¿æ¥

```bash
# ç›´æ¥è¿æ¥(å·²é…ç½®å¯†é’¥)
ssh root@124.223.35.102

# å¦‚æœéœ€è¦æŒ‡å®šå¯†é’¥
ssh -i ~/.ssh/id_rsa root@124.223.35.102
```

---

## ğŸ” ç¯å¢ƒå˜é‡é…ç½®

### åç«¯ `.env` æ–‡ä»¶ä½ç½®

- **æœ¬åœ°**: `æœ‹å‹åœˆè‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ/pyq-backend/.env`
- **æœåŠ¡å™¨**: `/www/wwwroot/pyq-backend/pyq-backend/.env`

### å®Œæ•´é…ç½®æ¸…å•

```env
# ==================== æ•°æ®åº“é…ç½® ====================
SUPABASE_URL=https://upcsdbcpmzpywvykiqtu.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVwY3NkYmNwbXpweXd2eWtpcXR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk2NzI5NzQsImV4cCI6MjA0NTI0ODk3NH0.Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVwY3NkYmNwbXpweXd2eWtpcXR1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcyOTY3Mjk3NCwiZXhwIjoyMDQ1MjQ4OTc0fQ.Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks_Ks

# ==================== JWTé…ç½® ====================
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# ==================== Coze APIé…ç½® ====================
# Cozeå·¥ä½œæµç”¨äºç”Ÿæˆæ–‡ç« AIæ‘˜è¦
COZE_API_KEY=sat_IypG3mLLmm4m1qaRx6qK4E0HpKN6z910uZlEuU9xzLKRja92fpeEVH4EcKsM0y9D
COZE_WORKFLOW_ID=7564955686342918154

# ==================== we-mp-rssé…ç½® ====================
# we-mp-rssæœåŠ¡ç”¨äºç›‘æ§å¾®ä¿¡å…¬ä¼—å·æ–‡ç« 
WE_MP_RSS_URL=http://124.223.35.102:8001
WE_MP_RSS_USERNAME=admin
WE_MP_RSS_PASSWORD=admin@123

# ==================== å †é›ªçƒé…ç½® ====================
# å †é›ªçƒè´¦å·ç”¨äºè‡ªåŠ¨å‘å¸ƒæœ‹å‹åœˆ
DUIXUEQIU_USERNAME=your-username
DUIXUEQIU_PASSWORD=your-password

# ==================== æœåŠ¡å™¨é…ç½® ====================
PORT=3000
NODE_ENV=production
```

### å…³é”®é…ç½®è¯´æ˜

#### 1. Coze APIé…ç½® (é‡è¦!)

- **ç”¨é€”**: è°ƒç”¨Cozeå·¥ä½œæµç”Ÿæˆæ–‡ç« AIæ‘˜è¦
- **Workflow ID**: `7564955686342918154`
- **API Key**: `sat_IypG3mLLmm4m1qaRx6qK4E0HpKN6z910uZlEuU9xzLKRja92fpeEVH4EcKsM0y9D`
- **æ³¨æ„**: å¦‚æœé…ç½®ç¼ºå¤±,ä¼šå¯¼è‡´æ–‡ç« åŒæ­¥å¤±è´¥(401é”™è¯¯)

#### 2. we-mp-rssé…ç½®

- **æœåŠ¡åœ°å€**: `http://124.223.35.102:8001`
- **é»˜è®¤è´¦å·**: `admin` / `admin@123`
- **Dockerå®¹å™¨**: è¿è¡Œåœ¨æœåŠ¡å™¨8001ç«¯å£
- **æ•°æ®ç›®å½•**: `/www/wwwroot/we-mp-rss-data`

#### 3. Supabaseé…ç½®

- **é¡¹ç›®URL**: https://upcsdbcpmzpywvykiqtu.supabase.co
- **ç”¨é€”**: æ•°æ®åº“å­˜å‚¨ã€æ–‡ä»¶å­˜å‚¨(Storage)
- **Storage Bucket**: `follow-circle-images` (å­˜å‚¨æœ‹å‹åœˆå›¾ç‰‡)

#### 4. å †é›ªçƒé…ç½®

- **ç”¨é€”**: è‡ªåŠ¨å‘å¸ƒæœ‹å‹åœˆåˆ°å †é›ªçƒç³»ç»Ÿ
- **è´¦å·ç®¡ç†**: å¯åœ¨å‰ç«¯"å †é›ªçƒè´¦å·ç®¡ç†"é¡µé¢é…ç½®
- **æ³¨æ„**: å¯†ç æ˜æ–‡å­˜å‚¨,åç»­éœ€è¦åŠ å¯†

#### 5. Puppeteeré…ç½® (é‡è¦!)

**ç¯å¢ƒå˜é‡**: `PUPPETEER_HEADLESS`

| ç¯å¢ƒ | æ¨èé…ç½® | è¯´æ˜ |
|------|---------|------|
| **æœ¬åœ°å¼€å‘(macOS/Windows)** | `PUPPETEER_HEADLESS=false` | æ˜¾ç¤ºæµè§ˆå™¨çª—å£,ä¾¿äºè°ƒè¯• |
| **ç”Ÿäº§æœåŠ¡å™¨(Linux)** | `PUPPETEER_HEADLESS=true` | æ— å¤´æ¨¡å¼,LinuxæœåŠ¡å™¨æ— å›¾å½¢ç•Œé¢ |

**âš ï¸ é‡è¦æç¤º**:
- ç”Ÿäº§æœåŠ¡å™¨**å¿…é¡»**è®¾ç½®ä¸º `true`,å¦åˆ™ä¼šæŠ¥é”™: `Missing X server to start the headful browser`
- æœ¬åœ°å¼€å‘å¯ä»¥è®¾ç½®ä¸º `false`,æ–¹ä¾¿è§‚å¯Ÿæµè§ˆå™¨æ“ä½œè¿‡ç¨‹
- ä¿®æ”¹åéœ€è¦é‡å¯æœåŠ¡: `pm2 restart pyq-backend`

**é…ç½®ç¤ºä¾‹**:

```env
# æœ¬åœ°å¼€å‘ç¯å¢ƒ (.env)
PUPPETEER_HEADLESS=false

# ç”Ÿäº§æœåŠ¡å™¨ç¯å¢ƒ (.env)
PUPPETEER_HEADLESS=true
```

---

## ğŸš€ æœ¬åœ°å¼€å‘ç¯å¢ƒ

### ç¯å¢ƒè¦æ±‚

- **Node.js**: 20.19.5+ (æ¨èä½¿ç”¨nvmç®¡ç†)
- **Pnpm**: 8.0+
- **Docker**: æœ€æ–°ç‰ˆæœ¬ (ç”¨äºwe-mp-rss)
- **æ•°æ®åº“**: Supabaseè´¦å· (å…è´¹)
- **æ“ä½œç³»ç»Ÿ**: macOS / Linux / Windows

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone [é¡¹ç›®åœ°å€]
cd æœ‹å‹åœˆè‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `pyq-backend` ç›®å½•åˆ›å»º `.env` æ–‡ä»¶,å‚è€ƒä¸Šé¢çš„[å®Œæ•´é…ç½®æ¸…å•](#å®Œæ•´é…ç½®æ¸…å•)ã€‚

#### 3. å¯åŠ¨we-mp-rssæœåŠ¡

```bash
docker run -d \
  --name we-mp-rss \
  -p 8001:8001 \
  -v $(pwd)/we-mp-rss-data:/app/data \
  -e ENABLE_JOB=True \
  -e SPAN_INTERVAL=3600 \
  ghcr.io/rachelos/we-mp-rss:latest
```

#### 4. å®‰è£…ä¾èµ–å¹¶å¯åŠ¨åç«¯

```bash
cd pyq-backend
npm install
npm run start:dev
```

#### 5. æ„å»ºå¹¶å¯åŠ¨å‰ç«¯ (æ¨èä½¿ç”¨ç”Ÿäº§æ„å»ºé¢„è§ˆ)

```bash
cd pyq-frontend-vben
pnpm install

# æ–¹æ³•ä¸€: ç”Ÿäº§æ„å»ºé¢„è§ˆæ¨¡å¼ (æ¨è,ä¸ç”Ÿäº§ç¯å¢ƒä¸€è‡´)
pnpm build:antd
cd apps/web-antd
pnpm vite preview

# æ–¹æ³•äºŒ: å¼€å‘æ¨¡å¼ (å®æ—¶çƒ­æ›´æ–°,ä½†éœ€è¦ç¡®ä¿vite.config.mtsä¸­é…ç½®äº†proxy)
# pnpm dev:antd
```

**é‡è¦è¯´æ˜**:
- **ç”Ÿäº§æ„å»ºé¢„è§ˆæ¨¡å¼** (`pnpm vite preview`):
  - âœ… ä¸ç”Ÿäº§ç¯å¢ƒå®Œå…¨ä¸€è‡´
  - âœ… è®¿é—®åœ°å€: http://localhost:4173
  - âš ï¸ ä¸æ”¯æŒVite proxy,éœ€è¦åç«¯CORSé…ç½® `http://localhost:4173`

- **å¼€å‘æ¨¡å¼** (`pnpm dev:antd`):
  - âœ… æ”¯æŒçƒ­æ›´æ–°,å¼€å‘æ•ˆç‡é«˜
  - âœ… è®¿é—®åœ°å€: http://localhost:5555
  - âœ… æ”¯æŒVite proxy,è‡ªåŠ¨ä»£ç† `/api` åˆ°åç«¯

#### 6. è®¿é—®åº”ç”¨

- **æœ¬åœ°æµ‹è¯•ç¯å¢ƒ** (æ¨è): http://localhost:4173
- **å¼€å‘ç¯å¢ƒ**: http://localhost:5555
- **åç«¯API**: http://localhost:3000/api

---

## ğŸš€ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### æœåŠ¡å™¨ç¯å¢ƒè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 7+
- **Node.js**: 20.19.5+ (ä½¿ç”¨nvmç®¡ç†)
- **PM2**: æœ€æ–°ç‰ˆæœ¬ (è¿›ç¨‹ç®¡ç†)
- **Nginx**: æœ€æ–°ç‰ˆæœ¬ (åå‘ä»£ç†)
- **Docker**: æœ€æ–°ç‰ˆæœ¬ (è¿è¡Œwe-mp-rss)
- **å®å¡”é¢æ¿**: 7.9+ (å¯é€‰,ä¾¿äºç®¡ç†)

### éƒ¨ç½²æ­¥éª¤

#### 1. å®‰è£…å®å¡”é¢æ¿

```bash
# Ubuntu/Debian
wget -O install.sh https://download.bt.cn/install/install-ubuntu_6.0.sh && sudo bash install.sh

# CentOS
yum install -y wget && wget -O install.sh https://download.bt.cn/install/install_6.0.sh && sh install.sh
```

#### 2. å®å¡”é¢æ¿é¦–æ¬¡é…ç½®

1. è®¿é—®å®‰è£…å®Œæˆåæ˜¾ç¤ºçš„é¢æ¿åœ°å€
2. ç™»å½•åå®‰è£…æ¨èçš„è½¯ä»¶æ ˆ:
   - Nginx 1.22+
   - MySQL 5.7+ (å¯é€‰,æœ¬é¡¹ç›®ä½¿ç”¨Supabase)
   - PHP 7.4+ (å¯é€‰)

#### 3. å®‰è£…å¿…è¦è½¯ä»¶

```bash
# å®‰è£…Docker
curl -fsSL https://get.docker.com | bash -s docker

# å¯åŠ¨Docker
systemctl start docker
systemctl enable docker
```

#### 4. å®‰è£…Node.js (ä½¿ç”¨nvm)

```bash
# å®‰è£…nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# é‡æ–°åŠ è½½shellé…ç½®
source ~/.bashrc

# å®‰è£…Node.js 20.19.5
nvm install 20.19.5
nvm use 20.19.5
nvm alias default 20.19.5

# å®‰è£…PM2
npm install -g pm2
```

#### 5. åˆ›å»ºé¡¹ç›®ç›®å½•å’Œé…ç½®æƒé™

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir -p /www/wwwroot/pyq-backend
mkdir -p /www/wwwroot/pyq-frontend

# è®¾ç½®æƒé™
chown -R www:www /www/wwwroot/pyq-backend
chown -R www:www /www/wwwroot/pyq-frontend
```

#### 6. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨

**æ–¹æ³•ä¸€: ä½¿ç”¨Git (æ¨è)**

```bash
cd /www/wwwroot/pyq-backend
git clone [é¡¹ç›®åœ°å€] .
```

**æ–¹æ³•äºŒ: ä½¿ç”¨SCP**

```bash
# åœ¨æœ¬åœ°æ‰§è¡Œ
scp -r pyq-backend root@124.223.35.102:/www/wwwroot/
```

#### 7. é…ç½®åç«¯ç¯å¢ƒå˜é‡

```bash
cd /www/wwwroot/pyq-backend/pyq-backend
nano .env
```

å¤åˆ¶ä¸Šé¢çš„[å®Œæ•´é…ç½®æ¸…å•](#å®Œæ•´é…ç½®æ¸…å•),ä¿®æ”¹ç›¸åº”çš„å€¼ã€‚

#### 8. å®‰è£…ä¾èµ–å¹¶æ„å»º

```bash
cd /www/wwwroot/pyq-backend/pyq-backend
npm install --production
npm run build
```

#### 9. å¯åŠ¨åç«¯æœåŠ¡

**ä½¿ç”¨PM2å¯åŠ¨**:

```bash
cd /www/wwwroot/pyq-backend/pyq-backend
pm2 start dist/main.js --name pyq-backend
pm2 save
pm2 startup
```

#### 10. éƒ¨ç½²å‰ç«¯

**æœ¬åœ°æ„å»º**:
```bash
cd pyq-frontend-vben
pnpm install
pnpm build:antd
```

**ä¸Šä¼ åˆ°æœåŠ¡å™¨**:
```bash
scp -r apps/web-antd/dist/* root@124.223.35.102:/www/wwwroot/pyq-frontend/
```

#### 11. é…ç½®Nginx

åˆ›å»ºNginxé…ç½®æ–‡ä»¶ `/www/server/panel/vhost/nginx/autochat.lfdhk.com.conf`:

```nginx
server {
    listen 80;
    listen 443 ssl http2;
    server_name autochat.lfdhk.com;

    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /www/server/panel/vhost/cert/autochat.lfdhk.com/fullchain.pem;
    ssl_certificate_key /www/server/panel/vhost/cert/autochat.lfdhk.com/privkey.pem;

    # å‰ç«¯é™æ€æ–‡ä»¶
    root /www/wwwroot/pyq-frontend;
    index index.html;

    # å‰ç«¯è·¯ç”±
    location / {
        try_files $uri $uri/ /index.html;
    }

    # åç«¯APIä»£ç†
    location /api {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    # WebSocketæ”¯æŒ
    location /socket.io {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

é‡è½½Nginx:
```bash
nginx -t
nginx -s reload
```

#### 12. å¯åŠ¨we-mp-rss

```bash
docker run -d \
  --name we-mp-rss \
  -p 8001:8001 \
  -v /www/wwwroot/we-mp-rss-data:/app/data \
  -e ENABLE_JOB=True \
  -e SPAN_INTERVAL=3600 \
  --restart=always \
  ghcr.io/rachelos/we-mp-rss:latest
```

---

## ğŸŒ ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®

### 1. Cozeå·¥ä½œæµ

**å·¥ä½œæµä¿¡æ¯**:
- **Workflow ID**: `7564955686342918154`
- **åŠŸèƒ½**: æ ¹æ®å…¬ä¼—å·æ–‡ç« é“¾æ¥ç”ŸæˆAIæ‘˜è¦
- **è¾“å…¥å‚æ•°**: `url` (å…¬ä¼—å·æ–‡ç« é“¾æ¥)
- **è¾“å‡º**: AIç”Ÿæˆçš„æ–‡ç« æ‘˜è¦(HTMLæ ¼å¼)

**APIè°ƒç”¨ç¤ºä¾‹**:
```bash
curl -X POST https://api.coze.cn/v1/workflow/run \
  -H "Authorization: Bearer sat_IypG3mLLmm4m1qaRx6qK4E0HpKN6z910uZlEuU9xzLKRja92fpeEVH4EcKsM0y9D" \
  -H "Content-Type: application/json" \
  -d '{
    "workflow_id": "7564955686342918154",
    "parameters": {
      "url": "https://mp.weixin.qq.com/s/xxx"
    }
  }'
```

### 2. we-mp-rssæœåŠ¡

**Dockerå¯åŠ¨å‘½ä»¤**:
```bash
docker run -d \
  --name we-mp-rss \
  -p 8001:8001 \
  -v /www/wwwroot/we-mp-rss-data:/app/data \
  -e ENABLE_JOB=True \
  -e SPAN_INTERVAL=3600 \
  --restart=always \
  ghcr.io/rachelos/we-mp-rss:latest
```

**æœåŠ¡ç®¡ç†**:
```bash
# æŸ¥çœ‹æ—¥å¿—
docker logs -f we-mp-rss

# é‡å¯æœåŠ¡
docker restart we-mp-rss

# åœæ­¢æœåŠ¡
docker stop we-mp-rss
```

### 3. Supabase Storage

**Bucketé…ç½®**:
- **åç§°**: `follow-circle-images`
- **ç”¨é€”**: å­˜å‚¨æœ‹å‹åœˆå‘å¸ƒä»»åŠ¡çš„å›¾ç‰‡
- **è®¿é—®æƒé™**: Public (å…¬å¼€è®¿é—®)
- **è‡ªåŠ¨æ¸…ç†**: æ¯å¤©å‡Œæ™¨3ç‚¹åˆ é™¤7å¤©å‰çš„å›¾ç‰‡

**RLSç­–ç•¥**:
```sql
-- å…è®¸æ‰€æœ‰äººä¸Šä¼ 
CREATE POLICY "Allow public uploads"
ON storage.objects FOR INSERT
TO public
WITH CHECK (bucket_id = 'follow-circle-images');

-- å…è®¸æ‰€æœ‰äººè¯»å–
CREATE POLICY "Allow public reads"
ON storage.objects FOR SELECT
TO public
USING (bucket_id = 'follow-circle-images');
```

---

## ğŸ—„ï¸ æ•°æ®åº“é…ç½®

### Supabaseæ•°æ®åº“ç®¡ç†

**ç™»å½•æ–¹å¼**:
1. è®¿é—®: https://supabase.com/dashboard/sign-in
2. ä½¿ç”¨GitHubè´¦å·ç™»å½•
3. é€‰æ‹©é¡¹ç›®: `pyq-system`

**æ‰§è¡ŒSQLæ“ä½œ**:
1. ç‚¹å‡»å·¦ä¾§èœå•"SQL Editor"
2. åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥SQLè¯­å¥
3. ç‚¹å‡»"Run"æŒ‰é’®æ‰§è¡Œ

**å¸¸ç”¨SQLæ“ä½œ**:

æŸ¥çœ‹æ‰€æœ‰è¡¨:
```sql
SELECT table_name
FROM information_schema.tables
WHERE table_schema = 'public';
```

æŸ¥çœ‹è¡¨ç»“æ„:
```sql
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_name = 'è¡¨å';
```

---

## ğŸ“ éƒ¨ç½²è·¯å¾„

### æœåŠ¡å™¨ç›®å½•ç»“æ„

```
/www/wwwroot/
â”œâ”€â”€ pyq-backend/
â”‚   â””â”€â”€ pyq-backend/          # åç«¯ä»£ç ç›®å½•
â”‚       â”œâ”€â”€ dist/             # ç¼–è¯‘åçš„ä»£ç 
â”‚       â”œâ”€â”€ src/              # æºä»£ç 
â”‚       â”œâ”€â”€ .env              # ç¯å¢ƒå˜é‡æ–‡ä»¶ â­
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ ...
â”œâ”€â”€ pyq-frontend/             # å‰ç«¯é™æ€æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets/
â”‚   â””â”€â”€ ...
â””â”€â”€ we-mp-rss-data/           # we-mp-rssæ•°æ®ç›®å½•
    â””â”€â”€ ...
```

### å…³é”®æ–‡ä»¶è·¯å¾„

| æ–‡ä»¶/ç›®å½• | è·¯å¾„ | è¯´æ˜ |
|----------|------|------|
| **åç«¯ç¯å¢ƒå˜é‡** | `/www/wwwroot/pyq-backend/pyq-backend/.env` | å¿…é¡»é…ç½® |
| **åç«¯å¯åŠ¨æ–‡ä»¶** | `/www/wwwroot/pyq-backend/pyq-backend/dist/main.js` | PM2å¯åŠ¨ |
| **å‰ç«¯é™æ€æ–‡ä»¶** | `/www/wwwroot/pyq-frontend/` | Nginx root |
| **we-mp-rssæ•°æ®** | `/www/wwwroot/we-mp-rss-data/` | DockeræŒ‚è½½ |
| **Nginxé…ç½®** | `/www/server/panel/vhost/nginx/autochat.lfdhk.com.conf` | ç½‘ç«™é…ç½® |
| **PM2è¿›ç¨‹** | `pyq-backend` | è¿›ç¨‹åç§° |

### PM2è¿›ç¨‹ç®¡ç†

**æŸ¥çœ‹è¿›ç¨‹**:
```bash
pm2 list
pm2 show pyq-backend
```

**æŸ¥çœ‹æ—¥å¿—**:
```bash
pm2 logs pyq-backend
pm2 logs pyq-backend --lines 100
```

**é‡å¯æœåŠ¡**:
```bash
pm2 restart pyq-backend
pm2 reload pyq-backend  # 0ç§’åœæœºé‡å¯
```

**åœæ­¢æœåŠ¡**:
```bash
pm2 stop pyq-backend
pm2 delete pyq-backend  # åˆ é™¤è¿›ç¨‹
```

---

## ğŸ“ å¸¸ç”¨éƒ¨ç½²å‘½ä»¤

### PM2ç®¡ç†

```bash
# æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹
pm2 list

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
pm2 show pyq-backend

# æŸ¥çœ‹æ—¥å¿—
pm2 logs pyq-backend
pm2 logs pyq-backend --lines 100

# é‡å¯æœåŠ¡
pm2 restart pyq-backend
pm2 reload pyq-backend  # 0ç§’åœæœºé‡å¯

# åœæ­¢æœåŠ¡
pm2 stop pyq-backend

# åˆ é™¤è¿›ç¨‹
pm2 delete pyq-backend

# ä¿å­˜é…ç½®
pm2 save

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
```

### Dockerç®¡ç†

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps
docker ps -a  # åŒ…å«åœæ­¢çš„å®¹å™¨

# æŸ¥çœ‹æ—¥å¿—
docker logs we-mp-rss
docker logs -f we-mp-rss  # å®æ—¶æ—¥å¿—

# é‡å¯å®¹å™¨
docker restart we-mp-rss

# åœæ­¢å®¹å™¨
docker stop we-mp-rss

# å¯åŠ¨å®¹å™¨
docker start we-mp-rss

# åˆ é™¤å®¹å™¨
docker rm we-mp-rss
docker rm -f we-mp-rss  # å¼ºåˆ¶åˆ é™¤
```

### Nginxç®¡ç†

```bash
# æµ‹è¯•é…ç½®
nginx -t

# é‡å¯Nginx
nginx -s reload
systemctl restart nginx

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /www/wwwlogs/error.log
tail -f /www/wwwlogs/autochat.lfdhk.com.error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f /www/wwwlogs/autochat.lfdhk.com.log
```

### ä»£ç æ›´æ–°

**åç«¯æ›´æ–°**:
```bash
cd /www/wwwroot/pyq-backend/pyq-backend
git pull
npm install
npm run build
pm2 restart pyq-backend
```

**å‰ç«¯æ›´æ–°**:
```bash
# æœ¬åœ°æ„å»º
cd pyq-frontend-vben
pnpm build:antd

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r apps/web-antd/dist/* root@124.223.35.102:/www/wwwroot/pyq-frontend/
```

---

## ğŸ” éƒ¨ç½²éªŒè¯

### 1. æ£€æŸ¥åç«¯æœåŠ¡

```bash
# æ£€æŸ¥è¿›ç¨‹
pm2 list

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep :3000

# æµ‹è¯•API
curl http://localhost:3000/api/health
```

### 2. æ£€æŸ¥å‰ç«¯éƒ¨ç½²

```bash
# æ£€æŸ¥æ–‡ä»¶
ls -lh /www/wwwroot/pyq-frontend/index.html

# æµ‹è¯•è®¿é—®
curl https://autochat.lfdhk.com/
```

### 3. æ£€æŸ¥we-mp-rss

```bash
# æ£€æŸ¥å®¹å™¨
docker ps | grep we-mp-rss

# æµ‹è¯•è®¿é—®
curl http://localhost:8001
```

---

## ğŸ“± ç§»åŠ¨ç«¯è®¿é—®

### è®¿é—®æ–¹å¼

ç³»ç»Ÿå·²å®Œç¾é€‚é…ç§»åŠ¨ç«¯,æ”¯æŒä»¥ä¸‹è®¿é—®æ–¹å¼:

1. **ç›´æ¥è®¿é—®**: åœ¨æ‰‹æœºæµè§ˆå™¨è¾“å…¥ https://autochat.lfdhk.com
2. **æ‰«ç è®¿é—®**: ä½¿ç”¨äºŒç»´ç ç”Ÿæˆå·¥å…·ç”Ÿæˆç½‘å€äºŒç»´ç ,å¾®ä¿¡æ‰«ç è®¿é—®
3. **æ·»åŠ åˆ°ä¸»å±å¹•**: åœ¨Safari/Chromeä¸­é€‰æ‹©"æ·»åŠ åˆ°ä¸»å±å¹•",åƒAppä¸€æ ·ä½¿ç”¨

### ç§»åŠ¨ç«¯ç‰¹æ€§

- âœ… **å“åº”å¼å¸ƒå±€**: æ‰€æœ‰é¡µé¢è‡ªåŠ¨é€‚é…æ‰‹æœºå±å¹•
- âœ… **è§¦æ‘¸ä¼˜åŒ–**: æŒ‰é’®å’Œäº¤äº’åŒºåŸŸé€‚åˆæ‰‹æŒ‡ç‚¹å‡»
- âœ… **å‚ç›´æ»šåŠ¨**: é•¿åˆ—è¡¨æ”¯æŒæµç•…æ»šåŠ¨
- âœ… **ç´§å‡‘è®¾è®¡**: ç§»åŠ¨ç«¯ä½¿ç”¨æ›´ç´§å‡‘çš„é—´è·å’Œå­—ä½“

### å…¬ä¼—å·ç›‘æ§é¡µé¢

ç§»åŠ¨ç«¯ç‰¹åˆ«ä¼˜åŒ–:
- **è®¢é˜…åˆ—è¡¨**: å å±å¹•ä¸Šæ–¹40%é«˜åº¦,å¯ä¸Šä¸‹æ»šåŠ¨
- **æ–‡ç« åˆ—è¡¨**: å å±å¹•ä¸‹æ–¹60%é«˜åº¦,å¯ä¸Šä¸‹æ»šåŠ¨
- **æ ‡ç­¾åˆ‡æ¢**: ç´§å‡‘çš„æ ‡ç­¾è®¾è®¡,æ–¹ä¾¿åˆ‡æ¢
- **æ“ä½œæŒ‰é’®**: é€‚åˆæ‰‹æŒ‡ç‚¹å‡»çš„å¤§å°

### æœ€ä½³å®è·µ

1. **å¼ºåˆ¶åˆ·æ–°**: æ›´æ–°åä½¿ç”¨ **ä¸‹æ‹‰åˆ·æ–°** æˆ– **æ¸…é™¤ç¼“å­˜**
2. **æ¨ªå±æ¨¡å¼**: éƒ¨åˆ†é¡µé¢æ¨ªå±æ˜¾ç¤ºæ•ˆæœæ›´ä½³
3. **WiFiç¯å¢ƒ**: é¦–æ¬¡åŠ è½½å»ºè®®ä½¿ç”¨WiFi,åŠ è½½æ›´å¿«

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“æ–‡æ¡£](./æ•°æ®åº“ç»“æ„æ–‡æ¡£.md) - æ•°æ®åº“ç»“æ„å’Œé…ç½®
- [æœåŠ¡å™¨å¸¸ç”¨å‘½ä»¤](./æœåŠ¡å™¨å¸¸ç”¨å‘½ä»¤.md) - è¿ç»´å‘½ä»¤å‚è€ƒ
- [å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](./å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ.md) - éƒ¨ç½²å¸¸è§é—®é¢˜
- [å±é™©æ“ä½œè­¦å‘Š](./å±é™©æ“ä½œè­¦å‘Š.md) - ç¦æ­¢çš„æ“ä½œ

---

[â† è¿”å›README](./README.md)

---

**æœ€åæ›´æ–°**: 2025-11-12
**ç»´æŠ¤è€…**: å°ç‰›é©¬

